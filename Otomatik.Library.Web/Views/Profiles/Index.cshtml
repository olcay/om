@model ProfileViewModel
@{
    ViewData[ViewDataParameters.Title] = Model.User.Name;
    ViewData[ViewDataParameters.UserName] = Model.User.Name;
    ViewData[ViewDataParameters.Tab] = Model.Tab;
}

<header class="page-header page-header-dark bg-dark">
    <div class="page-header-content">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-xl-8 col-lg-10 text-center">
                    <a href="https://gravatar.com/" target="_blank" title="Change profile picture"><img class="mb-4 rounded-circle" src="@Model.ImageUrl" style="width: 15rem;" /></a>
                    <h1 class="page-header-title">@Model.User.Name</h1>
                    <p class="page-header-text">
                        @if (Model.ShowActions && !Model.IsProfileOwner)
                        {
                            <button type="button" data-user-id="@Model.User.Id"
                                    class="btn btn-@(Model.IsFollowing ? "success" : "default") btn-lg js-toggle-follow">
                                Follow
                            </button>
                        }
                    </p>
                    <p class="page-header-text">
                        <button class="btn btn-link"><b>@Model.ShelvesCount</b> shelves</button>
                        <button class="btn btn-link" id="btnFollowers"><b>@Model.FollowersCount</b> followers</button>
                        <button class="btn btn-link" id="btnFollowing"><b>@Model.FollowingCount</b> following</button>
                    </p>
                </div>
            </div>
        </div>
    </div>
    <div class="svg-border-rounded text-white">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144.54 17.34" preserveAspectRatio="none" fill="currentColor"><path d="M144.54,17.34H0V0H144.54ZM0,0S32.36,17.34,72.27,17.34,144.54,0,144.54,0"></path></svg>
    </div>
</header>

<section class="bg-white py-5">
    <div class="container">
        <div class="row text-center">
            <div class="col-lg-12 mb-5 mb-lg-0">
                <a class="btn @Html.Raw(ViewData[ViewDataParameters.Tab].ToString() == ProfileTabs.Shelves ? "btn-primary" : "btn-link") btn-marketing rounded-pill" asp-controller="Profiles" asp-action="Index" asp-route-userName="@ViewData[ViewDataParameters.UserName]" asp-route-tab="@ProfileTabs.Shelves">Shelves</a>
                <a class="btn @Html.Raw(ViewData[ViewDataParameters.Tab].ToString() == ProfileTabs.Stars ? "btn-primary" : "btn-link") btn-marketing rounded-pill" asp-controller="Profiles" asp-action="Index" asp-route-userName="@ViewData[ViewDataParameters.UserName]" asp-route-tab="@ProfileTabs.Stars">Stars</a>
            </div>
        </div>
    </div>
</section>

<section class="bg-white py-1 pb-4">
    <div class="container">
        <div class="row text-center">
            <div class="col-lg-12 mb-5 mb-lg-0">
                <div class="card-columns" id="shelves">
                </div>
            </div>
        </div>
    </div>
</section>


@section Scripts{
    <script type="text/x-template" id="followers-template">
        <div class="list-group small mb-5">
            <%
            _.each(followers, function(follower){
            %>
            <a class="list-group-item list-group-item-action d-flex align-items-center justify-content-between" href="/p/<%= follower.name %>">
                <%= follower.name %><i class="fas fa-arrow-right fa-xs text-gray-400"></i>
            </a>
            <%
            })
            %>
        </div>
    </script>
    

    <script src="https://unpkg.com/%40popperjs/core@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/5.4.0/bootbox.min.js"></script>
    <script>
        $(document).ready(function () {
            ProfileController.init(".container", "@Model.User.Id", @Model.Page, "#followers-template");
        });
    </script>
}
