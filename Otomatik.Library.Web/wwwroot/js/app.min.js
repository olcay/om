var StarService=function(){var n=function(n,t,i){$.post({url:"/api/stars",data:{shelfId:n},headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(t).fail(i)};return{toggleStar:n}}(),FollowingService=function(){var n=function(n,t,i){$.post({url:"/api/followings",data:{followeeId:n},headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(t).fail(i)},t=function(n,t,i){$.get({url:"/api/"+n+"/followings",headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(t).fail(i)},i=function(n,t,i){$.get({url:"/api/"+n+"/followers",headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(t).fail(i)};return{toggleFollow:n,getFollowings:t,getFollowers:i}}(),ShelfService=function(){var n=function(n,t,i,r){$.get({url:"/api/"+n+"/shelves?page="+t,headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(i).fail(r)},t=function(n,t,i,r){$.get({url:"/api/"+n+"/starredShelves?page="+t,headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(i).fail(r)},i=function(n,t,i){$.ajax({url:"/api/shelves/"+n,method:"DELETE",headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(t).fail(i)},r=function(n,t,i){$.ajax({url:"/api/shelves/"+n+"/public",method:"PATCH",headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(t).fail(i)},u=function(n,t,i){$.ajax({url:"/api/shelves/"+n+"/private",method:"PATCH",headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(t).fail(i)};return{get:n,getStarred:t,remove:i,makePublic:r,makePrivate:u}}(),ItemService=function(){var n=function(n,t,i){$.ajax({url:"/api/items/"+n,method:"DELETE",headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(t).fail(i)},t=function(n,t,i,r,u,f){$.post({url:"/api/items/",data:{shelfId:i,gBookId:n,gameId:t,title:r},headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(u).fail(f)};return{remove:n,add:t}}(),NotificationService=function(){var n=function(n){$.getJSON("/api/notifications/",n)};return{get:n}}(),StarModule=function(n){var t,i=function(n){$(n).on("click",".js-toggle-star",r)},r=function(){t=$(this);n.toggleStar(t.data("shelf-id"),u,f)},u=function(n){n==="starred"?t.removeClass("btn-default").addClass("btn-warning"):t.removeClass("btn-warning").addClass("btn-default")},f=function(){swal("Something failed!","We could not process your request.","error")};return{init:i}}(StarService),FollowingModule=function(n){var t,i=function(n){$(n).on("click",".js-toggle-follow",r)},r=function(){t=$(this);n.toggleFollow(t.data("user-id"),u,f)},u=function(n){n==="following"?t.removeClass("btn-default").addClass("btn-success"):t.removeClass("btn-success").addClass("btn-default")},f=function(){swal("Something failed!","We could not process your request.","error")};return{init:i}}(FollowingService),ProfileController=function(n,t,i){var r=function(r,u,f){t.init(r);n.init(r);i.get(u,f)};return{init:r}}(FollowingModule,StarModule,ShelfService),ShelfController=function(n,t){var u,f=function(){$.fn.editable.defaults.mode="inline";$(".js-editable").editable({ajaxOptions:{headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}});$(".js-remove-book").click(a);$("#js-remove-shelf").click(c);$("#js-operation").on("click","#js-makePublic-shelf",e);$("#js-operation").on("click","#js-makePrivate-shelf",o)},e=function(n){n.preventDefault();var r=$("#js-makePublic-shelf");t.makePublic(r.data("shelf-id"),s,i)},o=function(n){n.preventDefault();var r=$("#js-makePrivate-shelf");t.makePrivate(r.data("shelf-id"),h,i)},s=function(){$("#js-makePublic-shelf").hide();$("#js-makePrivate-shelf").show();$("#lblIsPublic").hide()},h=function(){$("#js-makePublic-shelf").show();$("#js-makePrivate-shelf").hide();$("#lblIsPublic").show()},c=function(n){n.preventDefault();var r=$(this);swal({title:"Are you sure?",text:"Once deleted, you will not be able to recover this shelf!",icon:"warning",buttons:!0,dangerMode:!0}).then(n=>{n&&(u=r.data("user-name"),t.remove(r.data("shelf-id"),l,i))})},l=function(){window.location="/p/"+u},r,a=function(){r=$(this);swal({title:"Are you sure?",text:"Once deleted, you will not be able to recover this book!",icon:"warning",buttons:!0,dangerMode:!0}).then(t=>{t&&n.remove(r.data("book-id"),v,i)})},v=function(){r.parents(".thumbnail").fadeOut(function(){$(this).remove();salvattore.recreateColumns(document.querySelector("#grid"))})},i=function(){swal("Something failed!","We could not process your request.","error")};return{init:f}}(ItemService,ShelfService),HomeController=function(n){var t=function(t){n.init(t)};return{init:t}}(StarModule),NotificationController=function(n){var i,t,r=function(r,f){i=r;t=f;n.get(u)},u=function(n){var r,u;if(n.length!==0){r=0;$.each(n,function(n,t){t.isRead||r++});r>0&&($(t+" .js-notifications-count").text(r).removeClass("hide"),$(t+" .fa-bell").addClass("animate__animated animate__swing animate__repeat-2"));u=_.template($(i).html());$(t+" .dropdown-menu").html(u({notifications:n}));$(t).on("shown.bs.dropdown",function(){$.post({url:"/api/notifications/",headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(function(){$(t+" .js-notifications-count").text("").addClass("hide")})})}};return{init:r}}(NotificationService),BookController=function(n){var t,i=function(){$("#js-select-shelf").change(r);$(".js-add-book").click(u)},r=function(){var n=$("#js-select-shelf option:selected");$(".js-add-book").attr("data-original-title","Add to "+n.text())},u=function(){var r=$("#js-select-shelf option:selected").val(),i;t=$(this).data("title");i=$(this).data("book-id");n.add(i,null,r,t,f,e)},f=function(){var n=$("#js-select-shelf option:selected");swal("New book!",t+" is added successfully to "+n.text()+".","success")},e=function(n){swal("Something failed!","We could not process your request. "+n.responseText,"error")};return{init:i}}(ItemService),GameController=function(n){var t,i=function(){$("#js-select-shelf").change(r);$(".js-add-game").click(u)},r=function(){var n=$("#js-select-shelf option:selected");$(".js-add-book").attr("data-original-title","Add to "+n.text())},u=function(){var r=$("#js-select-shelf option:selected").val(),i;t=$(this).data("title");i=$(this).data("game-id");n.add(null,i,r,t,f,e)},f=function(){var n=$("#js-select-shelf option:selected");swal("New game!",t+" is added successfully to "+n.text()+".","success")},e=function(n){swal("Something failed!","We could not process your request. "+n.responseText,"error")};return{init:i}}(ItemService),ItemController=function(){var n=function(n){$.fn.editable.defaults.mode="inline";$(".js-editable").editable({ajaxOptions:{headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}});$("#myform").on("submit",function(i){i.preventDefault();var u=$(this),r=!1;window.FormData&&(r=new FormData(u[0]));$.ajax({url:"/api/items/"+n+"/cover",data:r?r:u.serialize(),cache:!1,contentType:!1,processData:!1,type:"PUT",success:function(n){t(n)}})})},t=function(n){$("#coverImage").attr("src",n);swal("Image uploaded!","The cover image is uploaded successfully.","success")},i=function(n){swal("Something failed!","We could not process your request. "+n.responseText,"error")};return{init:n}}(ItemService);