var StarService=function(){var n=function(n,t,i){$.post({url:"/api/stars",data:{shelfId:n},headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(t).fail(i)};return{toggleStar:n}}(),FollowingService=function(){var n=function(n,t,i){$.post({url:"/api/followings",data:{followeeId:n},headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(t).fail(i)};return{toggleFollow:n}}(),ShelfService=function(){var n=function(n,t,i){$.ajax({url:"/api/shelves/"+n,method:"DELETE",headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(t).fail(i)},t=function(n,t,i){$.ajax({url:"/api/shelves/"+n+"/public",method:"PATCH",headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(t).fail(i)},i=function(n,t,i){$.ajax({url:"/api/shelves/"+n+"/private",method:"PATCH",headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(t).fail(i)};return{remove:n,makePublic:t,makePrivate:i}}(),ItemService=function(){var n=function(n,t,i){$.ajax({url:"/api/items/"+n,method:"DELETE",headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(t).fail(i)},t=function(n,t,i,r,u){$.post({url:"/api/items/",data:{shelfId:t,gBookId:n,title:i},headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(r).fail(u)};return{remove:n,add:t}}(),NotificationService=function(){var n=function(n){$.getJSON("/api/notifications/",n)};return{get:n}}(),StarModule=function(n){var t,i=function(n){$(n).on("click",".js-toggle-star",r)},r=function(){t=$(this);n.toggleStar(t.data("shelf-id"),u,f)},u=function(n){n==="starred"?t.removeClass("btn-default").addClass("btn-warning"):t.removeClass("btn-warning").addClass("btn-default")},f=function(){swal("Something failed!","We could not process your request.","error")};return{init:i}}(StarService),FollowingModule=function(n){var t,i=function(n){$(n).on("click",".js-toggle-follow",r)},r=function(){t=$(this);n.toggleFollow(t.data("user-id"),u,f)},u=function(n){n==="following"?t.removeClass("btn-default").addClass("btn-success"):t.removeClass("btn-success").addClass("btn-default")},f=function(){swal("Something failed!","We could not process your request.","error")};return{init:i}}(FollowingService),ProfileController=function(n,t){var i=function(i){t.init(i);n.init(i)};return{init:i}}(FollowingModule,StarModule),ShelfController=function(n,t){var u,f=function(){$.fn.editable.defaults.mode="inline";$(".js-editable").editable({ajaxOptions:{headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}});$(".js-remove-book").click(a);$("#js-remove-shelf").click(c);$("#js-operation").on("click","#js-makePublic-shelf",e);$("#js-operation").on("click","#js-makePrivate-shelf",o)},e=function(n){n.preventDefault();var r=$("#js-makePublic-shelf");t.makePublic(r.data("shelf-id"),s,i)},o=function(n){n.preventDefault();var r=$("#js-makePrivate-shelf");t.makePrivate(r.data("shelf-id"),h,i)},s=function(){$("#js-makePublic-shelf").hide();$("#js-makePrivate-shelf").show();$("#lblIsPublic").hide()},h=function(){$("#js-makePublic-shelf").show();$("#js-makePrivate-shelf").hide();$("#lblIsPublic").show()},c=function(n){n.preventDefault();var r=$(this);swal({title:"Are you sure?",text:"Once deleted, you will not be able to recover this shelf!",icon:"warning",buttons:!0,dangerMode:!0}).then(n=>{n&&(u=r.data("user-name"),t.remove(r.data("shelf-id"),l,i))})},l=function(){window.location="/p/"+u},r,a=function(){r=$(this);swal({title:"Are you sure?",text:"Once deleted, you will not be able to recover this book!",icon:"warning",buttons:!0,dangerMode:!0}).then(t=>{t&&n.remove(r.data("book-id"),v,i)})},v=function(){r.parents(".thumbnail").fadeOut(function(){$(this).remove();salvattore.recreateColumns(document.querySelector("#grid"))})},i=function(){swal("Something failed!","We could not process your request.","error")};return{init:f}}(ItemService,ShelfService),HomeController=function(n){var t=function(t){n.init(t)};return{init:t}}(StarModule),NotificationController=function(n){var t,i,r=function(r,f){t=r;i=f;n.get(u)},u=function(n){if(n.length!==0){var r=0;$.each(n,function(n,t){t.isRead||r++});r>0&&$(".js-notifications-count").text(r).removeClass("hide").addClass("animated wobble");$(".notifications").popover({html:!0,title:"Notifications",trigger:"focus",content:function(){var i=_.template($(t).html());return i({notifications:n})},placement:"bottom",template:$(i).html()}).on("shown.bs.popover",function(){$.post({url:"/api/notifications/",headers:{RequestVerificationToken:$('input[name="__RequestVerificationToken"]').val()}}).done(function(){$(".js-notifications-count").text("").addClass("hide")})})}};return{init:r}}(NotificationService),BookController=function(n){var t,i=function(){$("#js-select-shelf").change(r);$(".js-add-book").click(u)},r=function(){var n=$("#js-select-shelf option:selected");$(".js-add-book").attr("data-original-title","Add to "+n.text())},u=function(){var r=$("#js-select-shelf option:selected").val(),i;t=$(this).data("title");i=$(this).data("book-id");n.add(i,r,t,f,e)},f=function(){var n=$("#js-select-shelf option:selected");swal("New book!",t+" is added successfully to "+n.text()+".","success")},e=function(n){swal("Something failed!","We could not process your request. "+n.responseText,"error")};return{init:i}}(ItemService);